import{m as G,u as J,z as K,i as O,r as l,A as Q,w as X,o as Z,a as v,b as V,c as x,d as o,t as _,B as q,k as r,s as ee,F as te}from"./index-7e3665c5.js";import{u as ae}from"./dataUser-20fc8260.js";import{u as oe}from"./dataAppointment-36412409.js";import{d as i}from"./day-a01efc22.js";const le={class:"flex align-items-center py-5 px-3"},se=o("i",{class:"pi pi-fw pi-check mr-2 text-2xl"},null,-1),ne={class:"m-0 text-lg"},de={class:"text-yellow-500 font-medium text-xl"},ie={class:"card p-fluid"},ue=o("h6",null,"Detalle de consulta",-1),re={class:"field grid"},ce=o("label",{for:"patients",class:"col-12 mb-2 md:col-2 md:mb-0"},"Paciente",-1),me={class:"col-12 md:col-10"},pe={class:"field grid"},ve=o("label",{for:"date",class:"col-12 mb-2 md:col-2 md:mb-0"},"Fecha",-1),_e={class:"col-12 md:col-10"},he={key:0,style:{padding:"50%",color:"green","font-size":"1.1em","background-color":"lightgreen","border-radius":"50%"},class:"available-date"},De={key:1},fe={class:"field grid"},ge=o("label",{for:"hour",class:"col-12 mb-2 md:col-2 md:mb-0"},"Horario",-1),ye={class:"col-12 md:col-10"},be={class:"field grid"},Se=o("label",{for:"hour",class:"col-12 mb-2 md:col-2 md:mb-0"},"Precio Consulta",-1),we={class:"col-12 md:col-10"},Ye=29,Te={__name:"Appointment",setup(Ae){const F=G(),C=J(),I=K(),c=O(),L=oe(),N=ae(),T=l(null),h=l(null),g=l(null),D=l(null),m=l(null),y=l([]),b=l([]),M=l(null),k=l([]),U=l([]),S=l([]),u=l([]),w=l(),E=l(null),p=l(new Date);p.value.setDate(p.value.getDate()+1);const Y=new Date(p);Y.setDate(p.value.getDate()+Ye);const P=Q(()=>t=>{const e=t.year,a=(t.month+1).toString().padStart(2,"0"),n=t.day.toString().padStart(2,"0");return`${e}-${a}-${n}`}),z=t=>{const e=i(t,"YYYY-MM-DD"),a=T.value.filter(d=>i(new Date(d.day),"YYYY-MM-DD")===e),n=[];a[0].timeSlot.forEach(d=>{n.push({code:d.timeSlotId,name:i(d.orderlyTurn,"hh:mm A")})}),h.value=n},$=t=>{h.value?t.query.trim().length?y.value=h.value.filter(e=>e.name.toLowerCase().startsWith(t.query.toLowerCase())):y.value=[...h.value]:C.add({severity:"warn",summary:"Alerta",detail:"Seleccione una fecha de cita Médica",life:3e3})},H=t=>{t.query.trim().length?b.value=g.value.filter(e=>e.name.toLowerCase().startsWith(t.query.toLowerCase())):b.value=[...g.value]};X(w,t=>{E.value=t,z(t)});const A=l(!1),W=async()=>{if(!R()){C.add({severity:"warn",summary:"Alerta",detail:"Datos incompletos",life:3e3});return}A.value=!0;const t={origin:"web",status:"pendiente",createAt:new Date,doctorId:u.value.doctor_id,userId:c.user.userId,dependentId:null,timeSlotId:D.value.code,appointmentServices:{create:[{medicalServiceId:1}]}};t[m.value.code===c.user.userId?"userId":"dependentId"]=m.value.code,await L.addappointment(t),F.push("/quote/payment"),A.value=!1},R=()=>m.value&&D.value,B=l(!0);return Z(async()=>{u.value=I.doctor[0],await I.getDoctorScheduleAvailable(u.value.doctor_id).then(a=>{T.value=a.map(n=>{let d=i(n.startTime,"hh:mm A"),f=i(n.endTime,"hh:mm A");return n.startTime=d,n.endTime=f,k.value.push(new Date(n.day)),n})});const t=[];for(let a=new Date(p.value);a<=Y;a.setDate(a.getDate()+1))t.push(new Date(a));S.value=k.value.map(a=>i(a,"YYYY-MM-DD")),U.value=t.filter(a=>!S.value.includes(i(a,"YYYY-MM-DD"))),M.value=await N.getUsersDependents(c.user.user.dni);const e=[];e.push({code:c.user.user.userId,name:c.user.user.name+" "+c.user.user.surnames}),M.value.forEach(a=>{e.push({code:a.dependentId,name:a.name+" "+a.surnames})}),e&&(g.value=e,m.value=e[0],B.value=!1)}),(t,e)=>{const a=v("Toast"),n=v("AutoComplete"),d=v("Calendar"),f=v("InputText"),j=v("Button");return V(),x(te,null,[o("div",le,[se,o("p",ne,"Médico: "+_(u.value.medico),1)]),o("p",de,"Las citas del dia "+_(q(i)(new Date,"DD/MM/YYYY"))+" se recervan via Call Center llamado al 985586350",1),o("div",ie,[o("h6",null,"Especialidad: "+_(u.value.specialization),1),ue,o("div",re,[ce,o("div",me,[r(a),r(n,{placeholder:"Nombre del paciente",id:"patients",dropdown:!0,modelValue:m.value,"onUpdate:modelValue":e[0]||(e[0]=s=>m.value=s),suggestions:b.value,onComplete:e[1]||(e[1]=s=>H(s)),field:"name",disabled:B.value},null,8,["modelValue","suggestions","disabled"])])]),o("div",pe,[ve,o("div",_e,[r(d,{placeholder:"Días disponibles",showIcon:!0,modelValue:w.value,"onUpdate:modelValue":e[2]||(e[2]=s=>w.value=s),manualInput:!1,minDate:p.value,maxDate:q(Y),disabledDates:U.value},{date:ee(s=>[S.value.includes(P.value(s.date))?(V(),x("div",he,_(s.date.day),1)):(V(),x("div",De,_(s.date.day),1))]),_:1},8,["modelValue","minDate","maxDate","disabledDates"])])]),o("div",fe,[ge,o("div",ye,[r(a),r(n,{placeholder:"Hora disponible",id:"timeSlot",dropdown:!0,modelValue:D.value,"onUpdate:modelValue":e[3]||(e[3]=s=>D.value=s),suggestions:y.value,onComplete:e[4]||(e[4]=s=>$(s)),field:"name"},null,8,["modelValue","suggestions"])])]),o("div",be,[Se,o("div",we,[r(f,{id:"price",type:"text",modelValue:u.value.price,"onUpdate:modelValue":e[5]||(e[5]=s=>u.value.price=s),disabled:!0},null,8,["modelValue"])])]),r(j,{label:"Siguiente",icon:"pi pi-arrow-right",class:"p-button-success col-12 md:col-3 mr-2 mb-2",loading:A.value,onClick:W},null,8,["loading"])])],64)}}};export{Te as default};
