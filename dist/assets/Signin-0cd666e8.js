import{u as k}from"./dataUser-cdcc4b67.js";import{k as E,u as q,h as A,r as p,w as R,i as $,a as i,b as h,c as V,d as o,e as a,t as T,n as D,l as U}from"./index-0df8eb20.js";const M={class:"card"},Y=o("h5",null,"Datos Personales",-1),z={class:"p-fluid formgrid grid"},L={class:"field col-12 md:col-6"},j=o("label",null,"Tipo de documento",-1),Z={class:"grid mt-2"},G={class:"col-4 md:col-4"},H={class:"field-radiobutton mb-0"},J=o("label",{for:"dni"},"DNI",-1),K={class:"col-4 md:col-4"},O={class:"field-radiobutton mb-0"},Q=o("label",{for:"ce"},"CE",-1),W={class:"col-4 md:col-4"},X={class:"field-radiobutton mb-0"},ee=o("label",{for:"pasaport"},"Pasaporte",-1),oe={class:"field col-12 md:col-6"},te={for:"document"},se={key:0,class:"p-invalid"},le={class:"field col-12 md:col-6"},ae=o("label",{for:"name"},"Nombre",-1),ne={class:"field col-12 md:col-6"},de=o("label",{for:"surnames"},"Apellidos",-1),ie={class:"field col-12 md:col-6"},re=o("label",{for:"email"},"Email",-1),ue={class:"field col-12 md:col-6"},ce=o("label",{for:"address"},"Dirección",-1),me={class:"field col-12 md:col-3"},pe=o("label",{for:"birthDate"},"Fecha de Nacimiento",-1),_e={class:"field col-12 md:col-3"},fe=o("label",{for:"sex"},"Sexo",-1),ve={class:"field col-12 md:col-3"},he=o("label",{for:"civilStatus"},"Estado Civil",-1),Ve={class:"field col-12 md:col-3"},be=o("label",{for:"phone"},"Teléfono",-1),ge={key:0,class:"p-invalid"},Ue={__name:"Signin",setup(ye){const b=E(),x=q(),r=A(),_=k(),u=p(!1);R(()=>r.sessionUser,async l=>{l&&await r.currentUser(r.user.username)});const S=p([{name:"Masculino",code:"Masculino"},{name:"Femenino",code:"Femenino"}]),C=p([{name:"Soltero",code:"Soltero"},{name:"Casado",code:"Casado"},{name:"Divorciado",code:"Divorciado"},{name:"Viudo",code:"Viudo"}]),e=$({documentType:"",dni:"",name:"",surnames:"",phone:"",email:"",address:"",birthDate:"",sex:"",civilStatus:""}),c=p(!1),m=(l,t,n)=>{x.add({severity:l,summary:t,life:n})},w=()=>{const l=["documentType","dni","name","surnames","phone","email","address","birthDate","sex","civilStatus"];for(const t of l)if(!e[t])return m("error","Por favor, complete todos los campos obligatorios.",3e3),!1;return!0},B=()=>{const l=new Date,t=new Date(e.birthDate);return l.getFullYear()-t.getFullYear()<18?(m("error","Debes ser mayor de edad para registrarte. Registra a tu padre o apoderado",5e3),!1):!0},f=l=>/^[0-9]{9}$/.test(l),v=l=>e.documentType==="DNI"?/^\d{8}$/.test(l):e.documentType==="CE"?/^\d{9}$/.test(l):e.documentType==="Pasaporte"?/^[A-Za-z0-9]{5,20}$/.test(l):!0,I=async()=>{if(u.value=!0,!w()||!B()||!v(e.dni)||!f(e.phone))return;if(c.value=!0,console.log(e),await _.addPatients(e),_.msg==="Violación de la restricción única."){m("error","DNI registrado anteriormente!",5e3),c.value=!1;return}const l={username:e.dni,password:e.dni};console.log(l),await r.login(l),console.log("mensaje user",_.msg),r.sessionUser&&(m("success","Validación Correcta Bienvenido",3e3),setTimeout(()=>b.push("/quotes"),2e3)),setTimeout(()=>c.value=!1,1e3)},N=()=>{setTimeout(()=>b.push("/auth/login"),500)};return(l,t)=>{const n=i("RadioButton"),d=i("InputText"),P=i("Calendar"),g=i("Dropdown"),F=i("Toast"),y=i("Button");return h(),V("div",M,[Y,o("div",z,[o("div",L,[j,o("div",Z,[o("div",G,[o("div",H,[a(n,{id:"dni",name:"option",value:"DNI",modelValue:e.documentType,"onUpdate:modelValue":t[0]||(t[0]=s=>e.documentType=s)},null,8,["modelValue"]),J])]),o("div",K,[o("div",O,[a(n,{id:"ce",name:"option",value:"CE",modelValue:e.documentType,"onUpdate:modelValue":t[1]||(t[1]=s=>e.documentType=s)},null,8,["modelValue"]),Q])]),o("div",W,[o("div",X,[a(n,{id:"pasaport",name:"option",value:"Pasaporte",modelValue:e.documentType,"onUpdate:modelValue":t[2]||(t[2]=s=>e.documentType=s)},null,8,["modelValue"]),ee])])])]),o("div",oe,[o("label",te,T(e.documentType),1),a(d,{id:"document",type:"text",modelValue:e.dni,"onUpdate:modelValue":t[3]||(t[3]=s=>e.dni=s),class:D({"p-invalid":u.value&&!e.dni||!v(e.dni)})},null,8,["modelValue","class"]),u.value&&!e.dni||!v(e.dni)?(h(),V("small",se,T(e.documentType)+" es requerido o formato inválido",1)):U("",!0)]),o("div",le,[ae,a(d,{id:"name",type:"text",modelValue:e.name,"onUpdate:modelValue":t[4]||(t[4]=s=>e.name=s)},null,8,["modelValue"])]),o("div",ne,[de,a(d,{id:"surnames",type:"text",modelValue:e.surnames,"onUpdate:modelValue":t[5]||(t[5]=s=>e.surnames=s)},null,8,["modelValue"])]),o("div",ie,[re,a(d,{id:"email",type:"text",modelValue:e.email,"onUpdate:modelValue":t[6]||(t[6]=s=>e.email=s)},null,8,["modelValue"])]),o("div",ue,[ce,a(d,{id:"address",type:"text",modelValue:e.address,"onUpdate:modelValue":t[7]||(t[7]=s=>e.address=s)},null,8,["modelValue"])]),o("div",me,[pe,a(P,{showIcon:!0,showButtonBar:!0,modelValue:e.birthDate,"onUpdate:modelValue":t[8]||(t[8]=s=>e.birthDate=s),dateFormat:"dd/mm/yy"},null,8,["modelValue"])]),o("div",_e,[fe,a(g,{id:"sex",modelValue:e.sex,"onUpdate:modelValue":t[9]||(t[9]=s=>e.sex=s),options:S.value,optionLabel:"name",placeholder:"Selecciona",optionValue:"code"},null,8,["modelValue","options"])]),o("div",ve,[he,a(g,{id:"civilStatus",modelValue:e.civilStatus,"onUpdate:modelValue":t[10]||(t[10]=s=>e.civilStatus=s),options:C.value,optionLabel:"name",placeholder:"Selecciona",optionValue:"code"},null,8,["modelValue","options"])]),o("div",Ve,[be,a(d,{id:"phone",modelValue:e.phone,"onUpdate:modelValue":t[11]||(t[11]=s=>e.phone=s),modelModifiers:{trim:!0},class:D({"p-invalid":u.value&&!e.phone||!f(e.phone)})},null,8,["modelValue","class"]),u.value&&!e.phone||!f(e.phone)?(h(),V("small",ge," Teléfono es requerido o formato inválido")):U("",!0)])]),a(F),a(y,{label:"Agendar Cita",icon:"pi pi-calendar",class:"p-button-success col-12 md:col-3 mr-2 mb-2",loading:c.value,onClick:I},null,8,["loading"]),a(y,{label:"Ya estas registrado ?",icon:"pi pi-user",class:"p-button-info col-12 md:col-3 p-button-text mr-2 mb-2",onClick:N})])}}};export{Ue as default};
