import{u as M,h as k,r as m,i as T,o as B,a as i,b as I,c as N,d as e,t as F,e as t,F as S,j as w}from"./index-16712e5a.js";import{d as z,a as L}from"./day-a01efc22.js";import{b as Y}from"./config-11bc3e6e.js";const A=e("div",{className:"card"},[e("h5",null,"Información Personal"),e("p",null,[w("Su contraseña por defecto será su DNI, cambiela regularmente para mayor seguridad; paña añadir a menores de edad o personas a su cargo por favor selesccione "),e("strong",null,'"Dependientes"'),w(";")])],-1),j={className:"grid"},E={class:"col-12 md:col-6"},R={class:"card p-fluid"},$=e("h5",null,"Perfil",-1),q={class:"field"},H={for:"dni"},O={class:"field"},G=e("label",{for:"name"},"Nombre",-1),J={class:"field"},K=e("label",{for:"email"},"Email",-1),Q={class:"field"},W=e("label",{for:"city"},"Fecha de Nacimiento",-1),X={class:"field"},Z=e("label",{for:"phone"},"Teléfono",-1),ee={class:"col-12 md:col-6"},ae={class:"card p-fluid"},oe={class:"text-center mb-5"},se=e("div",{class:"text-900 text-3xl font-medium mb-3"},"Foto de perfil",-1),te=e("h5",null,"Modificar Contraseña",-1),le={class:"p-float-label mt-6"},ne=e("label",{for:"password"},"Contraseña",-1),de={class:"p-float-label mt-5"},re=e("label",{for:"password1"},"Confirmar Contraseña",-1),pe={__name:"Profile",setup(ie){const p=M(),l=k(),r=m(!1),n=m(""),c=m(""),f=m(""),v=m(""),a=T({documentType:"",dni:"",name:"",surnames:"",phone:"",email:"",address:"",birthDate:""}),_=(s,o)=>{r.value=!1,p.add({severity:s,summary:o,life:3e3})},y=async()=>{if(r.value=!0,!n.value||!c.value)_("warn","Por favor complete los campos requeridos");else if(n.value!=c.value)_("warn","Las contraseñas no coinciden");else if(/\s/.test(n.value))_("warn","Los campos no pueden contener espacios en blanco");else if(n.value.length<6)_("warn","La contraseña debe tener al menos 6 caracteres");else{const s={password:n.value};await l.updateAccessUser(s)==1&&(p.add({severity:"success",summary:"Contraseña actualizada",life:4e3}),n.value="",c.value="")}r.value=!1},V=async()=>{p.add({severity:"success",summary:"Datos actualizados correctamente",life:4e3}),await l.currentUser(l.user.username),await l.getUrlProfilePhoto().then(s=>f.value=s)},U=s=>(s.xhr.setRequestHeader("Authorization",l.user.token),s),D=async()=>{r.value=!0,console.log(a);const s={birthDate:new Date(L(a.birthDate)),email:a.email,phone:a.phone};await l.updateDataUser(s),p.add({severity:"success",summary:"Datos actualizados correctamente",life:4e3}),n.value="",c.value="",r.value=!1};return B(async()=>{console.log(l.user.username),await l.currentUser(l.user.username);const s=l.user.user;Object.assign(a,s);const o=z(a.birthDate,"DD MMMM YYYY");a.birthDate=o,console.log(a),await l.getUrlProfilePhoto().then(u=>f.value=u),v.value=`${Y}/api/v1/users/photoprofile/${a.dni}`}),(s,o)=>{const u=i("InputText"),P=i("Calendar"),h=i("Button"),x=i("Image"),b=i("Toast"),C=i("FileUpload"),g=i("Password");return I(),N(S,null,[A,e("div",j,[e("div",E,[e("div",R,[$,e("div",q,[e("label",H,F(a.documentType.toUpperCase()),1),t(u,{id:"dni",type:"text",disabled:!0,"v-model":a.dni,modelValue:a.dni},null,8,["v-model","modelValue"])]),e("div",O,[G,t(u,{id:"name",type:"text",disabled:!0,"v-model":a.name,modelValue:a.name+" "+a.surnames},null,8,["v-model","modelValue"])]),e("div",J,[K,t(u,{id:"email",type:"text",modelValue:a.email,"onUpdate:modelValue":o[0]||(o[0]=d=>a.email=d)},null,8,["modelValue"])]),e("div",Q,[W,t(P,{showIcon:!0,showButtonBar:!0,modelValue:a.birthDate,"onUpdate:modelValue":o[1]||(o[1]=d=>a.birthDate=d),disabled:!1},null,8,["modelValue"])]),e("div",X,[Z,t(u,{id:"phone",type:"text",modelValue:a.phone,"onUpdate:modelValue":o[2]||(o[2]=d=>a.phone=d)},null,8,["modelValue"])]),t(h,{label:"Modificar",icon:"pi pi-user",class:"p-button-success col-12 md:col-3 mr-2 mb-2",loading:r.value,onClick:D},null,8,["loading"])])]),e("div",ee,[e("div",ae,[e("div",oe,[se,t(x,{src:f.value,alt:"Image",width:"150",preview:""},null,8,["src"]),t(b),t(C,{class:"mt-2",mode:"basic",name:"profilePhoto",url:v.value,onBeforeSend:U,accept:"image/*",maxFileSize:1e6,onUpload:V},null,8,["url"])]),te,e("span",le,[t(g,{id:"password",type:"password",toggleMask:!0,modelValue:n.value,"onUpdate:modelValue":o[3]||(o[3]=d=>n.value=d)},null,8,["modelValue"]),ne]),e("span",de,[t(g,{id:"password1",type:"password",toggleMask:!0,modelValue:c.value,"onUpdate:modelValue":o[4]||(o[4]=d=>c.value=d)},null,8,["modelValue"]),re]),t(b),t(h,{label:"Modificar",icon:"pi pi-unlock",class:"p-button-success col-12 md:col-3 mr-2 mb-2 mt-5",loading:r.value,onClick:y},null,8,["loading"])])])])],64)}}};export{pe as default};
