import{u as N,i as T,r as p,j as I,o as F,a as i,b as v,c as y,d as e,t as z,k as t,e as S,f as V,F as A,l as U}from"./index-7e3665c5.js";import{d as L,a as Y}from"./day-a01efc22.js";import{b as j}from"./config-11bc3e6e.js";const E=e("div",{className:"card"},[e("h5",null,"Información Personal"),e("p",null,[U("Su contraseña por defecto será su DNI, cambiela regularmente para mayor seguridad; paña añadir a menores de edad o personas a su cargo por favor selesccione "),e("strong",null,'"Dependientes"'),U(";")])],-1),R={className:"grid"},$={class:"col-12 md:col-6"},q={class:"card p-fluid"},H=e("h5",null,"Perfil",-1),O={class:"field"},G={for:"dni"},J={class:"field"},K=e("label",{for:"name"},"Nombre",-1),Q={class:"field"},W=e("label",{for:"email"},"Email",-1),X={class:"field"},Z=e("label",{for:"city"},"Fecha de Nacimiento",-1),ee={class:"field"},ae=e("label",{for:"phone"},"Teléfono",-1),oe={class:"col-12 md:col-6"},se={class:"card p-fluid"},te={class:"text-center mb-5"},le=e("div",{class:"text-900 text-3xl font-medium mb-3"},"Foto de perfil",-1),ne={key:1},de=e("h5",null,"Modificar Contraseña",-1),re={class:"p-float-label mt-6"},ie=e("label",{for:"password"},"Contraseña",-1),ce={class:"p-float-label mt-5"},ue=e("label",{for:"password1"},"Confirmar Contraseña",-1),ve={__name:"Profile",setup(me){const _=N(),l=T(),r=p(!1),n=p(""),c=p(""),m=p(""),h=p(""),a=I({documentType:"",dni:"",name:"",surnames:"",phone:"",email:"",address:"",birthDate:""}),f=(s,o)=>{r.value=!1,_.add({severity:s,summary:o,life:3e3})},D=async()=>{if(r.value=!0,!n.value||!c.value)f("warn","Por favor complete los campos requeridos");else if(n.value!=c.value)f("warn","Las contraseñas no coinciden");else if(/\s/.test(n.value))f("warn","Los campos no pueden contener espacios en blanco");else if(n.value.length<6)f("warn","La contraseña debe tener al menos 6 caracteres");else{const s={password:n.value};await l.updateAccessUser(s)==1&&(_.add({severity:"success",summary:"Contraseña actualizada",life:4e3}),n.value="",c.value="")}r.value=!1},P=async()=>{_.add({severity:"success",summary:"Datos actualizados correctamente",life:4e3}),await l.currentUser(l.user.username),await l.getUrlProfilePhoto().then(s=>m.value=s)},x=s=>(s.xhr.setRequestHeader("Authorization",l.user.token),s),k=async()=>{r.value=!0;const s={birthDate:new Date(Y(a.birthDate)),email:a.email,phone:a.phone};await l.updateDataUser(s),_.add({severity:"success",summary:"Datos actualizados correctamente",life:4e3}),n.value="",c.value="",r.value=!1};return F(async()=>{await l.currentUser(l.user.username);const s=l.user.user;Object.assign(a,s);const o=L(a.birthDate,"DD MMMM YYYY");a.birthDate=o,await l.getUrlProfilePhoto().then(u=>m.value=u),h.value=`${j}/api/v1/users/photoprofile/${a.dni}`}),(s,o)=>{const u=i("InputText"),C=i("Calendar"),b=i("Button"),M=i("Image"),w=i("Toast"),B=i("FileUpload"),g=i("Password");return v(),y(A,null,[E,e("div",R,[e("div",$,[e("div",q,[H,e("div",O,[e("label",G,z(a.documentType.toUpperCase()),1),t(u,{id:"dni",type:"text",disabled:!0,"v-model":a.dni,modelValue:a.dni},null,8,["v-model","modelValue"])]),e("div",J,[K,t(u,{id:"name",type:"text",disabled:!0,"v-model":a.name,modelValue:a.name+" "+a.surnames},null,8,["v-model","modelValue"])]),e("div",Q,[W,t(u,{id:"email",type:"text",modelValue:a.email,"onUpdate:modelValue":o[0]||(o[0]=d=>a.email=d)},null,8,["modelValue"])]),e("div",X,[Z,t(C,{showIcon:!0,showButtonBar:!0,modelValue:a.birthDate,"onUpdate:modelValue":o[1]||(o[1]=d=>a.birthDate=d),disabled:!1},null,8,["modelValue"])]),e("div",ee,[ae,t(u,{id:"phone",type:"text",modelValue:a.phone,"onUpdate:modelValue":o[2]||(o[2]=d=>a.phone=d)},null,8,["modelValue"])]),t(b,{label:"Modificar",icon:"pi pi-user",class:"p-button-success col-12 md:col-3 mr-2 mb-2",loading:r.value,onClick:k},null,8,["loading"])])]),e("div",oe,[e("div",se,[e("div",te,[le,m.value.message?V("",!0):(v(),S(M,{key:0,src:m.value,alt:"Image",width:"150",preview:""},null,8,["src"])),m.value.message?(v(),y("span",ne," Actualiza tu foto de perfil")):V("",!0),t(w),t(B,{class:"mt-2",mode:"basic",name:"profilePhoto",url:h.value,onBeforeSend:x,accept:"image/*",maxFileSize:1e6,onUpload:P},null,8,["url"])]),de,e("span",re,[t(g,{id:"password",type:"password",toggleMask:!0,modelValue:n.value,"onUpdate:modelValue":o[3]||(o[3]=d=>n.value=d)},null,8,["modelValue"]),ie]),e("span",ce,[t(g,{id:"password1",type:"password",toggleMask:!0,modelValue:c.value,"onUpdate:modelValue":o[4]||(o[4]=d=>c.value=d)},null,8,["modelValue"]),ue]),t(w),t(b,{label:"Modificar",icon:"pi pi-unlock",class:"p-button-success col-12 md:col-3 mr-2 mb-2 mt-5",loading:r.value,onClick:D},null,8,["loading"])])])])],64)}}};export{ve as default};
